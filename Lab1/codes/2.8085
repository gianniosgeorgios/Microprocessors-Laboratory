IN 10H		;Αίρει την προστασία της μνήμης 

LDA 2000H	;Έλεγχος LSB
ANI 01H
CPI 01H
JNZ CONTINUE 


;Ενεργοποίηση της διακοπής RST6.5
MVI A,0DH   ;Α = 00001101hex
SIM         ;Set Interrupt Mask
EI	     ;Ενεργοποίηση των διακοπών (Enable Interrupt)

;Αρχικοποίησης της 7-segment οθόνης 
;και φόρτωση στη μνήμη του κωδικου 10H
;για κενό χαρακτήρα 

;Αρίθμηση απο δεξιά προς τα αριστερά 

CONTINUE:

LXI H,0BF1H 		;2ο ψηφίο
MVI M,10H

INX H 			;3ο ψηφίο
MVI M,10H   		

INX H	     		;4ο ψηφίο
MVI M,10H   		

INX H	     		;5ο ψηφίο	
MVI M,10H   		

INX H			;6ο ψηφίο
MVI M,10H

LXI H,0BF0H		;1ο ψηφίο
MVI M,00H

   
LXI B,00C8H 		;Καθυστέρηση 200msec 

COUNTER_FROM_ZERO:
MVI E,00H		;Αρχικοποίηση μετρητή LED

COUNTER:
	LDA 2000H	;Eλεγχος lsb
	ANI 01H
	CPI 01H
	JZ ENABLE_2	;
	DI		;lsb κλειστο -> απενεργοποίηση διακοπών
       MVI D,00H	;D σημαία : 0, όταν οι διακοπές απενεργοποιημένες
			;	     1, αλλιώς 
CONT:
	MOV A,E
	
	CPI F8H	;σύγκριση με επόμενη καταστάση(απο F0H)
	JZ COUNTER_FROM_ZERO

	ANI F0H	;απομόνωση 4 msb
	
	CMA
	CALL DELB
	
	STA 3000H	;εμφάνιση στα led
	CMA
       ADI 10H	;αύξηση κατά 8 
	MOV E,A	;ενημέρωση μετρητή
       CALL DCD	;ανανέωση οθόνης
	JMP COUNTER

ENABLE_2:
	MVI A,0DH    ;Α = 00001101hex
       SIM          ;Set Interrupt Mask
	EI	      ;Ενεργοποίηση των διακοπών (Enable Interrupt)
	MVI D,01H
       JMP CONT

INTR_ROUTINE:
       PUSH PSW 	;Αποθήκευσης Α,σημαιών στο stack 
       MOV A,D       ;έλεγχος σημαίας D (Υπόδειξη 2)
       CPI 00H
       JZ NOTCASE
       INR M         ;αύξηση μνήμης κατά ένα (διακοπών)
	MOV A,M
	CPI 0AH       ;για μεγαλύτερες ή ίσες με 10 πήγαινε στο "greater"
	JNC GREATER	;για υπολογισμό modulo 
       CALL DCD      ;ανανέωση οθόνης
       EI
	POP PSW	;επαναφορά Α,σημαιων από stack 
	RET	       ;επιστροφή στο κυρίως πρόγραμμα
GREATER:
       SUI 0AH	;Μεγαλύτερη τιμη απο 10-> Αφαίρεση 10
       MOV M,A
       CALL DCD	;ανανέωση οθόνης
       EI
	POP PSW
	RET

NOTCASE:		;Όχι διακοπές όσο διακοπές απενεργοποιημένες
	POP PSW
       RET	       ;επιστροφή στο κυρίως πρόγραμμα
END